{"version":3,"sources":["webpack:///webpack/bootstrap 6c1a27fc72c0486d2de0","webpack:///external \"express\"","webpack:///external \"body-parser\"","webpack:///./nuxt.config.js","webpack:///./server/api/index.js","webpack:///external \"compression\"","webpack:///external \"nuxt\"","webpack:///./server/api/home.js","webpack:///./server/config.js","webpack:///./server/db/connection.js","webpack:///./server/db/crud.js","webpack:///external \"mongodb\"","webpack:///external \"wagner-core\"","webpack:///./server/index.js"],"names":["module","exports","head","title","meta","charset","name","content","hid","link","rel","type","href","css","src","lang","build","vendor","extend","config","ctx","isClient","rules","push","enforce","test","loader","exclude","bodyParser","require","wagner","home","factory","router","Router","use","express","crudFn","crudInst","conf","params","invoke","conn","then","db","catch","err","console","log","index","indexNoDB","get","req","res","iterable","getItems","collection","items_per_page","projection","slug","aggregation","$match","$exists","$sort","$limit","$project","_id","catalogs","$unwind","Promise","all","results","json","categories","stores","routes","error","user","password","host","shard1","shard2","shard3","queryString","MongoClient","getConnection","url","connect","DATABASE","COLLECTION","ITEMS_PER_PAGE","getPagination","searchItems","find","query","sort","skip","limit","toArray","docs","score","$meta","count","numItems","numPages","Math","ceil","pages","total","aggregate","data","app","process","env","HOST","port","PORT","set","nuxtConfig","dev","nuxt","compression","render","exit","listen"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6c1a27fc72c0486d2de0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 1\n// module chunks = 0","module.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'Ofertadeo',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Ofertadeo' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n    ]\n  },\n  /*\n  ** Global CSS\n  */\n  css: [\n     { src: '~assets/css/main.scss', lang: 'scss' }, // scss instead of sass\n     '~assets/css/roboto-material-icons.css'\n  ],\n  /*\n  ** Add axios globally\n  */\n  build: {\n    vendor: ['axios', 'vue-material'],\n    /*\n    ** Run ESLINT on save\n    */\n    extend (config, ctx) {\n      if (ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import { Router } from 'express'\nvar bodyParser = require('body-parser');\nvar wagner = require('wagner-core');\nvar config = require('../config.js');\nvar home = require('./home');\n\nwagner.factory('config', function(){\n  return config;\n});\nrequire('../db/connection.js')(wagner);\n\nvar router = Router()\n// Add USERS Routes\nrouter.use(home(wagner))\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/index.js","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 5\n// module chunks = 0","'use strict';\n\nvar express = require('express');\nvar router = express.Router();\nvar crudFn = require('../db/crud.js');\n\nvar crudInst;\nvar conf;\nmodule.exports = function(wagner, params) {\n  wagner.invoke(function(conn, config) {\n    conf = config;\n    return conn;\n  })\n  .then(function(db){\n    crudInst = crudFn({\n      db:db\n    });\n  })\n  .catch(function(err) {\n    //some configuration to notify no database connection working\n    console.log(err);\n  })\n  .then(function(){\n    if(crudInst) {\n      index();  \n    } else {\n      indexNoDB();\n    }\n    \n  });\n\n  return router;\n};\n\nfunction index() {\n  router.get('/home', function(req, res) {\n    var iterable = [\n      crudInst.getItems({ collection: 'categories', items_per_page: 20}),\n      crudInst.getItems({ collection: 'stores', items_per_page: 20, projection: {name: 1, slug: 1 } }),\n      crudInst.aggregation(\n          { collection: 'stores', \n          aggregation: [\n            { $match: { \"catalogs.0\": { $exists: true}} },\n            { $sort: { name: 1} },\n            { $limit: 5 },\n            { $project: { _id: 0, catalogs: 1}},\n            { $unwind: \"$catalogs\" },\n            { $project: { \"catalogs.title\": 1, \"catalogs.thumbnail\": 1}}\n          ]\n      })\n    ];\n\n    Promise.all(iterable)\n    .then(function(results) {\n      res.json({\n          categories: results[0],\n          stores: results[1],\n          catalogs: results[2],\n          routes: conf.routes\n        });\n    })\n    .catch(function(error) {\n      console.log(error)\n      res.json(error);\n    });\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/home.js","'use strict';\r\n\r\nmodule.exports = {\r\n  db: {\r\n    user: \"ofertadeo_user\",\r\n    password: \"Cdo_2017*\",\r\n    name: 'ofertadeo',\r\n    host: 'ds131621.mlab.com:31621',\r\n    shard1: 'pensemosweb-shard-00-00-147ev.mongodb.net:27017',\r\n    shard2: 'pensemosweb-shard-00-01-147ev.mongodb.net:27017',\r\n    shard3: 'pensemosweb-shard-00-02-147ev.mongodb.net:27017',\r\n    queryString: '?ssl=true&replicaSet=pensemosweb-shard-0&authSource=admin'\r\n  },\r\n  routes: {\r\n    categories: '/categorias',\r\n    stores: '/folletos-catalogos'\r\n  }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./server/config.js","'use strict';\r\n\r\nvar MongoClient = require('mongodb').MongoClient;\r\n \r\nfunction getConnection(config) {\r\n  //connPromise is pending when trying to connect to mongodb atlas\r\n// var shards = config.db.shard1 + ',' + config.db.shard2 + ',' + config.db.shard3;\r\n// var url = 'mongodb://' + config.db.user + ':' + config.db.password + '@' + shards + '/' + config.db.name + config.db.queryString;\r\nvar url = 'mongodb://' + config.db.user + ':' + config.db.password + '@' + config.db.host + '/' + config.db.name;\r\n\r\n  return MongoClient.connect(url).then(function(conn){\r\n      console.log('It is connected to db: ' + config.db.name);\r\n      return conn;\r\n    })\r\n    .catch(function(err) {\r\n      console.log(err);\r\n      return err;\r\n    });\r\n}\r\n\r\nmodule.exports = function(wagner) {\r\n  wagner.invoke(function(config) {\r\n    var conn = getConnection(config);\r\n    wagner.factory('conn', function() {\r\n      return conn;\r\n    });\r\n  });\r\n  \r\n};\n\n\n// WEBPACK FOOTER //\n// ./server/db/connection.js","'use strict';\n\nvar DATABASE;\nvar COLLECTION;\nvar ITEMS_PER_PAGE;\n\nmodule.exports = function(params) {\n  COLLECTION = params.collection;\n  DATABASE = params.db;\n  ITEMS_PER_PAGE = params.items_per_page || 6;\n\n  return {\n    getPagination: getPagination,\n    getItems: getItems,\n    searchItems: searchItems,\n    aggregation: aggregation\n  };\n};\n\nfunction getItems(params) {\n  var db = DATABASE || params.db;\n  return db.collection(COLLECTION || params.collection)\n    .find(params.query || {}, params.projection || {} )\n    .sort(params.sort || { _id: 1})\n    .skip(params.skip || 0)\n    .limit(params.items_per_page || ITEMS_PER_PAGE)\n    .toArray()\n    .then(function(docs) {\n      return docs;\n    })\n    .catch(function(err) {\n      return err;\n    });\n}\n\nfunction searchItems(params) {\n  var db = DATABASE || params.db;\n  return db.collection(COLLECTION || params.collection)\n    //we project the textScore meta data and then we sort the results by the best matches first\n    .find(params.query, params.projection || { score: { $meta: 'textScore'} })\n    .sort(params.sort || { score: { $meta: 'textScore'} })\n    .skip(params.skip || 0)\n    .limit(params.items_per_page || ITEMS_PER_PAGE)\n    .toArray()\n    .then(function(docs) {\n      return docs;\n    })\n    .catch(function(err) {\n      return err;\n    });\n}\n\nfunction getPagination(params) {\n  var db = DATABASE || params.db;\n  return db.collection(COLLECTION || params.collection)\n    .find(params.query)\n    .count()\n    .then(function(numItems){\n      var items_per_page = params.items_per_page || ITEMS_PER_PAGE;\n      var numPages = 0;\n      if (numItems > items_per_page ) {\n        numPages = Math.ceil(numItems/items_per_page);\n      }\n      return {\n        pages: numPages,\n        total: numItems\n      };\n    })\n    .catch(function(err){\n      return err;\n    });\n}\n\nfunction aggregation(params) {\n  var db = DATABASE || params.db;\n  return db.collection(COLLECTION || params.collection)\n    .aggregate(params.aggregation)\n    .toArray()\n    .then(function(data){\n      return data\n    })\n    .catch(function(err){\n      return err\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./server/db/crud.js","module.exports = require(\"mongodb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongodb\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"wagner-core\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"wagner-core\"\n// module id = 11\n// module chunks = 0","import Nuxt from 'nuxt'\nimport express from 'express'\nimport compression from 'compression'\n\nimport api from './api'\n\nvar bodyParser = require('body-parser');\n\nconst app = express()\nconst host = process.env.HOST || '127.0.0.1'\nconst port = process.env.PORT || 3000\n\napp.set('port', port)\n\n// Import API Routes\napp.use('/api', api)\n\n// Import and Set Nuxt.js options\nlet nuxtConfig = require('../nuxt.config.js')\nnuxtConfig.dev = !(process.env.NODE_ENV === 'production')\n\n// Init Nuxt.js\nconst nuxt = new Nuxt(nuxtConfig)\n//before nuxt render to compress data\napp.set('view cache', true);//Cache template compilation\napp.use(compression());//Compress all the data that the server response\n\n//At the end because it won't call next()\napp.use(nuxt.render)\n\n// Build only in dev mode\nif (nuxtConfig.dev) {\n  nuxt.build()\n  .catch((error) => {\n    console.error(error) // eslint-disable-line no-console\n    process.exit(1)\n  })\n}\n\n// Listen the server\napp.listen(port, host)\nconsole.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}