{"version":3,"sources":["webpack:///webpack/bootstrap 4c8172b41799a7e521cc","webpack:///external \"express\"","webpack:///./server/db/crud.js","webpack:///external \"body-parser\"","webpack:///external \"wagner-core\"","webpack:///./nuxt.config.js","webpack:///./server/api/index.js","webpack:///external \"compression\"","webpack:///external \"nuxt\"","webpack:///./server/api/categories.js","webpack:///./server/api/home.js","webpack:///./server/api/promotions.js","webpack:///./server/api/stores.js","webpack:///./server/config.js","webpack:///./server/db/connection.js","webpack:///external \"mongodb\"","webpack:///external \"path\"","webpack:///./server/index.js"],"names":["DATABASE","COLLECTION","ITEMS_PER_PAGE","module","exports","params","collection","db","items_per_page","getPagination","getItems","getItem","searchItems","aggregation","find","query","projection","sort","_id","skip","limit","toArray","then","docs","catch","err","score","$meta","count","numItems","numPages","Math","ceil","pages","total","aggregate","data","loading","color","height","head","title","meta","charset","name","content","hid","rel","href","property","link","type","sizes","htmlAttrs","lang","css","src","build","vendor","extend","config","ctx","isClient","rules","push","enforce","test","loader","exclude","bodyParser","require","wagner","home","categories","stores","promotions","router","Router","use","express","crudFn","crudInst","conf","invoke","conn","console","log","index","indexNoDB","get","req","res","page","Number","iterable","mainCollection","thumbnail","store_id","slug","img_alt","img_title","img","Promise","all","results","json","items","info","pagination","error","url","modified","item","url_site","path","user","password","host","shard1","shard2","shard3","queryString","routes","categoriesList","main","storeList","paths","root","resolve","__dirname","server","static","factory","MongoClient","getConnection","connect","app","process","env","HOST","port","PORT","set","nuxtConfig","dev","nuxt","compression","render","exit","listen"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4c8172b41799a7e521cc","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","'use strict';\n\nvar DATABASE;\nvar COLLECTION;\nvar ITEMS_PER_PAGE;\n\nmodule.exports = function(params) {\n  COLLECTION = params.collection;\n  DATABASE = params.db;\n  ITEMS_PER_PAGE = params.items_per_page || 6;\n\n  return {\n    getPagination: getPagination,\n    getItems: getItems,\n    getItem: getItem,\n    searchItems: searchItems,\n    aggregation: aggregation\n  };\n};\n\nfunction getItems(params) {\n  var db = DATABASE || params.db;\n  var items_per_page = params.items_per_page || ITEMS_PER_PAGE;\n  return db.collection(COLLECTION || params.collection)\n    .find(params.query || {}, params.projection || {} )\n    .sort(params.sort || { _id: 1})\n    .skip(params.skip || 0)\n    .limit(items_per_page)\n    .toArray()\n    .then(function(docs) {\n      if (items_per_page > 1) {\n        return docs;\n      } else {\n        return docs[0];\n      }\n    })\n    .catch(function(err) {\n      return err;\n    });\n}\n\nfunction getItem(params) {\n  params.items_per_page = 1;\n  return getItems(params);\n}\n\nfunction searchItems(params) {\n  var db = DATABASE || params.db;\n  return db.collection(COLLECTION || params.collection)\n    //we project the textScore meta data and then we sort the results by the best matches first\n    .find(params.query, params.projection || { score: { $meta: 'textScore'} })\n    .sort(params.sort || { score: { $meta: 'textScore'} })\n    .skip(params.skip || 0)\n    .limit(params.items_per_page || ITEMS_PER_PAGE)\n    .toArray()\n    .then(function(docs) {\n      return docs;\n    })\n    .catch(function(err) {\n      return err;\n    });\n}\n\nfunction getPagination(params) {\n  var db = DATABASE || params.db;\n  return db.collection(COLLECTION || params.collection)\n    .find(params.query || {})\n    .count()\n    .then(function(numItems){\n      var items_per_page = params.items_per_page || ITEMS_PER_PAGE;\n      var numPages = 0;\n      if (numItems > items_per_page ) {\n        numPages = Math.ceil(numItems/items_per_page);\n      }\n      return {\n        pages: numPages,\n        total: numItems\n      };\n    })\n    .catch(function(err){\n      return err;\n    });\n}\n\nfunction aggregation(params) {\n  var db = DATABASE || params.db;\n  return db.collection(COLLECTION || params.collection)\n    .aggregate(params.aggregation)\n    .toArray()\n    .then(function(data){\n      return data\n    })\n    .catch(function(err){\n      return err\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./server/db/crud.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"wagner-core\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"wagner-core\"\n// module id = 3\n// module chunks = 0","module.exports = {\n  loading: {\n    color: '#42a5f5',\n    height: '11px'\n  },\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'Ofertas, promociones y descuentos en México | Ofertadeo',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { name: 'theme-color', content:'#1976d2' },\n      { name: 'msapplication-TileColor', content: '#2d89ef' },\n      { name: 'msapplication-TileImage', content: '/favicons/mstile-144x144.png' },\n      { name: 'msapplication-config', content: '/favicons/browserconfig.xml' },\n      { hid: 'title', name: 'title', content: 'Ofertas, promociones y descuentos en México | Ofertadeo' },\n      { hid: 'publisher', rel: 'publisher', href: 'https://plus.google.com/110009950298317863923' },\n      { hid: 'description', name: 'description', content: 'Descubre las mejores ofertas, promociones y descuentos en México de las principales tiendas de tu ciudad.  ✓ ¡Ahorra con ofertadeo!' },\n      { hid: 'og:locale', property: 'og:locale', content: 'es-MX' },\n      { hid: 'og:type', property: 'og:type', content: 'website' },\n      { hid: 'og:site_name', property: 'og:site_name', content: 'Ofertadeo' },\n      { hid: 'og:title', property: 'og:title', content: 'Ofertas, promociones y descuentos en México | Ofertadeo' },\n      { hid: 'og:description', property: 'og:description', content: 'Descubre las mejores ofertas, promociones y descuentos en México de las principales tiendas de tu ciudad.  ✓ ¡Ahorra con ofertadeo!' },\n      { hid: 'og:url', property: 'og:url', content: 'https://ofertadeo.com' },\n      { hid: 'og:image', property: 'og:image', content: 'https://ofertadeo.com/logo.png' },\n      { hid: 'og:image:secure_url', property: 'og:image:secure_url', content: 'https://ofertadeo.com/logo.png' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\n      { rel: 'apple-touch-icon', sizes: '180x180', href: '/favicons/apple-touch-icon.png' },\n      { rel: 'icon', type: 'image/png', sizes: '32x32', href: '/favicons/favicon-32x32.png' },\n      { rel: 'icon', type: 'image/png', sizes: '16x16', href: '/favicons/favicon-16x16.png' },\n      { rel: 'manifest', href: '/favicons/manifest.json'},\n      { rel: 'mask-icon', href: '/favicons/safari-pinned-tab.svg', color: '#1976d2' },\n      { rel: 'shortcut icon', href: '/favicons/favicon.ico' }\n    ],\n    htmlAttrs: {\n      lang: 'es-MX'\n    }\n  },\n  /*\n  ** Global CSS\n  */\n  css: [\n     { src: '~assets/css/main.scss', lang: 'scss' }, // scss instead of sass\n     '~assets/css/roboto-material-icons.css'\n  ],\n  /*\n  ** Add axios globally\n  */\n  build: {\n    vendor: ['axios', '~plugins/striptags.js'],\n    /*\n    ** Run ESLINT on save\n    */\n    extend (config, ctx) {\n      if (ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import { Router } from 'express'\nvar bodyParser = require('body-parser');\nvar wagner = require('wagner-core');\nvar home = require('./home');\nvar categories = require('./categories');\nvar stores = require('./stores');\nvar promotions = require('./promotions');\n\nrequire('../config.js')(wagner);\nrequire('../db/connection.js')(wagner);\n\nvar router = Router()\n// Add USERS Routes\nrouter.use(home(wagner))\nrouter.use(categories(wagner))\nrouter.use(stores(wagner))\nrouter.use(promotions(wagner))\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/index.js","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 7\n// module chunks = 0","'use strict';\n\nvar express = require('express');\nvar router = express.Router();\nvar crudFn = require('../db/crud.js');\nvar ITEMS_PER_PAGE = 6;\nvar COLLECTION = 'categories';\n\nvar crudInst;\nvar conf;\nmodule.exports = function(wagner, params) {\n  wagner.invoke(function(conn, config) {\n    conf = config;\n    return conn;\n  })\n  .then(function(db){\n    crudInst = crudFn({\n      db:db\n    });\n  })\n  .catch(function(err) {\n    //some configuration to notify no database connection working\n    console.log(err);\n  })\n  .then(function(){\n    if(crudInst) {\n      _id();\n      index()\n    } else {\n      indexNoDB();\n    }\n    \n  });\n\n  return router;\n};\n\nfunction _id() {\n  router.get('/categories/:_id', function(req, res) {\n    var page = req.query.page ? Number(req.query.page) : 0;\n    var iterable = [\n      crudInst.getItems({\n        collection: conf.db.mainCollection,\n        query: { categories: req.params._id },\n        items_per_page: ITEMS_PER_PAGE, \n        skip: ITEMS_PER_PAGE*page,\n        projection: {name: 1, thumbnail: 1, store_id: 1, slug: 1, img_alt: 1, img_title: 1}\n      }),\n      crudInst.getItem({\n        collection:  COLLECTION,\n        query: {_id: req.params._id},\n        projection: {name:1, thumbnail: 1, slug: 1, content: 1, img: 1, img_alt: 1, img_title: 1}\n      }),\n      crudInst.getPagination({\n        query: { store_id: req.params._id },\n        collection: conf.db.mainCollection\n      })\n    ];\n\n    Promise.all(iterable)\n    .then(function(results) {\n      res.json({\n          items: results[0],\n          info: results[1],\n          pagination: results[2]\n        });\n    })\n    .catch(function(error) {\n      res.json(error);\n    });\n  });\n}\n\nfunction index() {\n  router.get('/categories', function(req, res) {\n    var page = req.query.page ? Number(req.query.page) : 0;\n    var iterable = [\n      crudInst.getItems({\n        collection: COLLECTION,\n        items_per_page: ITEMS_PER_PAGE, \n        skip: ITEMS_PER_PAGE*page,\n        projection: { name: 1, slug: 1, thumbnail: 1, img_alt:1, img_title: 1 }\n      }),\n      crudInst.getPagination({\n        collection: COLLECTION\n      })\n    ];\n\n    Promise.all(iterable)\n    .then(function(results) {\n      res.json({\n          items: results[0],\n          pagination: results[1]\n        });\n    })\n    .catch(function(error) {\n      res.json(error);\n    });\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/categories.js","'use strict';\r\n\r\nvar express = require('express');\r\nvar router = express.Router();\r\nvar crudFn = require('../db/crud.js');\r\nvar ITEMS_PER_PAGE = 6;\r\nvar COLLECTION = 'offers';\r\n\r\nvar crudInst;\r\nvar conf;\r\nmodule.exports = function(wagner, params) {\r\n  wagner.invoke(function(conn, config) {\r\n    conf = config;\r\n    return conn;\r\n  })\r\n  .then(function(db){\r\n    crudInst = crudFn({\r\n      db:db\r\n    });\r\n  })\r\n  .catch(function(err) {\r\n    //some configuration to notify no database connection working\r\n    console.log(err);\r\n  })\r\n  .then(function(){\r\n    if(crudInst) {\r\n      index();  \r\n    } else {\r\n      indexNoDB();\r\n    }\r\n    \r\n  });\r\n\r\n  return router;\r\n};\r\n\r\nfunction index() {\r\n  router.get('/home', function(req, res) {\r\n    var page = req.query.page ? Number(req.query.page) : 0;\r\n    var iterable = [\r\n      crudInst.getItems({\r\n        collection: COLLECTION,\r\n        items_per_page: ITEMS_PER_PAGE, \r\n        skip: ITEMS_PER_PAGE*page,\r\n        projection: { name: 1, thumbnail: 1, store_id: 1, slug: 1, img_alt:1, img_title: 1, title: 1 }\r\n      }),\r\n      crudInst.getPagination({\r\n        collection: COLLECTION,\r\n      })\r\n    ];\r\n\r\n    Promise.all(iterable)\r\n    .then(function(results) {\r\n      res.json({\r\n          items: results[0],\r\n          pagination: results[1]\r\n        });\r\n    })\r\n    .catch(function(error) {\r\n      res.json(error);\r\n    });\r\n  });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/home.js","'use strict';\r\n\r\nvar express = require('express');\r\nvar router = express.Router();\r\nvar crudFn = require('../db/crud.js');\r\n\r\nvar crudInst;\r\nvar conf;\r\nmodule.exports = function(wagner, params) {\r\n  wagner.invoke(function(conn, config) {\r\n    conf = config;\r\n    return conn;\r\n  })\r\n  .then(function(db){\r\n    crudInst = crudFn({\r\n      db:db\r\n    });\r\n  })\r\n  .catch(function(err) {\r\n    //some configuration to notify no database connection working\r\n    console.log(err);\r\n  })\r\n  .then(function(){\r\n    if(crudInst) {\r\n      slug();  \r\n    }    \r\n  });\r\n\r\n  return router;\r\n};\r\n\r\nfunction slug() {\r\n  router.get('/promotions/:slug', function(req, res) {\r\n    var iterable = [\r\n      crudInst.getItem({\r\n        collection: conf.db.mainCollection,\r\n        query: { slug: req.params.slug },\r\n        items_per_page: 1, \r\n        projection: { name: 1, thumbnail: 1, store_id: 1, categories: 1, slug: 1, content: 1, url: 1, img: 1, modified: 1, img_alt: 1, img_title: 1} })\r\n    ];\r\n\r\n    return Promise.all(iterable)\r\n          .then(function(results) {\r\n            res.json({\r\n                item: results[0]\r\n              });\r\n          })\r\n          .catch(function(error) {\r\n            res.json(error);\r\n          });\r\n        });\r\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/promotions.js","'use strict';\n\nvar express = require('express');\nvar router = express.Router();\nvar crudFn = require('../db/crud.js');\nvar ITEMS_PER_PAGE = 6;\nvar COLLECTION = 'stores';\n\nvar crudInst;\nvar conf;\nmodule.exports = function(wagner, params) {\n  wagner.invoke(function(conn, config) {\n    conf = config;\n    return conn;\n  })\n  .then(function(db){\n    crudInst = crudFn({\n      db:db\n    });\n  })\n  .catch(function(err) {\n    //some configuration to notify no database connection working\n    console.log(err);\n  })\n  .then(function(){\n    if(crudInst) {\n      _id();\n      index();\n    }\n  });\n\n  return router;\n};\n\nfunction _id() {\n  router.get('/stores/:_id', function(req, res) {\n    var page = req.query.page ? Number(req.query.page) : 0;\n    var iterable = [\n      crudInst.getItems({\n        collection: conf.db.mainCollection,\n        query: { store_id: req.params._id },\n        items_per_page: ITEMS_PER_PAGE,\n        skip: ITEMS_PER_PAGE*page,\n        projection: {name: 1, thumbnail: 1, store_id: 1, slug: 1, img: 1, img_alt:1, img_title:1 }\n      }),\n      crudInst.getItem({\n        collection:  COLLECTION,\n        query: {_id: req.params._id},\n        projection: {name:1, thumbnail: 1, slug: 1, url_site: 1, content: 1, img: 1, img_alt:1, img_title: 1}\n      }),\n      crudInst.getPagination({\n        query: { store_id: req.params._id },\n        collection: conf.db.mainCollection\n      })\n    ];\n\n    Promise.all(iterable)\n    .then(function(results) {\n      res.json({\n          items: results[0],\n          info: results[1],\n          pagination: results[2]\n        });\n    })\n    .catch(function(error) {\n      res.json(error);\n    });\n  });\n}\n\nfunction index() {\n  router.get('/stores', function(req, res) {\n    var page = req.query.page ? Number(req.query.page) : 0;\n    var iterable = [\n      crudInst.getItems({\n        collection: COLLECTION,\n        items_per_page: ITEMS_PER_PAGE, \n        skip: ITEMS_PER_PAGE*page,\n        projection: { name: 1, slug: 1, thumbnail: 1, img_alt:1, img_title:1 }\n      }),\n      crudInst.getPagination({\n        collection: COLLECTION\n      })\n    ];\n\n    Promise.all(iterable)\n    .then(function(results) {\n      res.json({\n          items: results[0],\n          pagination: results[1]\n        });\n    })\n    .catch(function(error) {\n      console.log(error);\n      res.json(error);\n    });\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./server/api/stores.js","'use strict';\r\n\r\nvar wagner = require('wagner-core');\r\nvar path = require('path');\r\n\r\nvar config = {\r\n  db: {\r\n    user: \"ofertadeo\",\r\n    password: \"Cdo_2017*\",\r\n    name: 'ofertadeo',\r\n    host: 'ds161471.mlab.com:61471',\r\n    shard1: 'pensemosweb-shard-00-00-147ev.mongodb.net:27017',\r\n    shard2: 'pensemosweb-shard-00-01-147ev.mongodb.net:27017',\r\n    shard3: 'pensemosweb-shard-00-02-147ev.mongodb.net:27017',\r\n    queryString: '?ssl=true&replicaSet=pensemosweb-shard-0&authSource=admin',\r\n    mainCollection: 'offers'\r\n  },\r\n  routes: {\r\n    categories: '/categorias',\r\n    categoriesList: '/categorias',\r\n    stores: '/promociones',\r\n    main: '/promociones',\r\n    storeList: '/tiendas'\r\n  },\r\n  host: 'https://www.ofertadeo.com',\r\n  paths: {\r\n    root: path.resolve(__dirname, '../'),\r\n    server: __dirname,\r\n    static:  path.resolve(__dirname, '../static')\r\n  }\r\n};\r\n\r\nmodule.exports = function (wagner) {\r\n  if (wagner) {\r\n    wagner.factory('config', function (){\r\n      return config;\r\n    });\r\n  }\r\n  return config;\r\n};\r\n\r\nmodule.exports.config = config;\n\n\n// WEBPACK FOOTER //\n// ./server/config.js","'use strict';\r\n\r\nvar MongoClient = require('mongodb').MongoClient;\r\n \r\nfunction getConnection(config) {\r\n  //connPromise is pending when trying to connect to mongodb atlas\r\n  // var shards = config.db.shard1 + ',' + config.db.shard2 + ',' + config.db.shard3;\r\n  // var url = 'mongodb://' + config.db.user + ':' + config.db.password + '@' + shards + '/' + config.db.name + config.db.queryString;\r\n  var url = 'mongodb://' + config.db.user + ':' + config.db.password + '@' + config.db.host + '/' + config.db.name;\r\n\r\n  return MongoClient.connect(url).then(function(conn){\r\n      console.log('It is connected to db: ' + config.db.name + ' in ' + config.db.host );\r\n      return conn;\r\n    })\r\n    .catch(function(err) {\r\n      console.log(err);\r\n      return err;\r\n    });\r\n}\r\n\r\nmodule.exports = function(wagner) {\r\n  wagner.invoke(function(config) {\r\n    var conn = getConnection(config);\r\n    wagner.factory('conn', function() {\r\n      return conn;\r\n    });\r\n  });\r\n  \r\n};\n\n\n// WEBPACK FOOTER //\n// ./server/db/connection.js","module.exports = require(\"mongodb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongodb\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 15\n// module chunks = 0","import Nuxt from 'nuxt'\nimport express from 'express'\nimport compression from 'compression'\n\nimport api from './api'\n\nvar bodyParser = require('body-parser');\n\nconst app = express()\nconst host = process.env.HOST || '127.0.0.1'\nconst port = process.env.PORT || 3000\n\napp.set('port', port)\n\n// Import API Routes\napp.use('/api', api)\n\n// Import and Set Nuxt.js options\nlet nuxtConfig = require('../nuxt.config.js')\nnuxtConfig.dev = !(process.env.NODE_ENV === 'production')\n\n// Init Nuxt.js\nconst nuxt = new Nuxt(nuxtConfig)\n//before nuxt render to compress data\napp.set('view cache', true);//Cache template compilation\napp.use(compression());//Compress all the data that the server response\n\n//At the end because it won't call next()\napp.use(nuxt.render)\n\n// Build only in dev mode\nif (nuxtConfig.dev) {\n  nuxt.build()\n  .catch((error) => {\n    console.error(error) // eslint-disable-line no-console\n    process.exit(1)\n  })\n}\n\n// Listen the server\napp.listen(port)\nconsole.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}